"0","set.seed(2022)"
"0","# mean=0, sd=1, normal distribution"
"0","z = rnorm(100)"
"0",""
"0","h.grid = seq(from = 0.01, to = 1, length.out = 20)"
"0","h.grid"
"1"," [1]"
"1"," 0.01000000"
"1"," 0.06210526"
"1"," 0.11421053"
"1"," 0.16631579"
"1","
"
"1"," [5]"
"1"," 0.21842105"
"1"," 0.27052632"
"1"," 0.32263158"
"1"," 0.37473684"
"1","
"
"1"," [9]"
"1"," 0.42684211"
"1"," 0.47894737"
"1"," 0.53105263"
"1"," 0.58315789"
"1","
"
"1","[13]"
"1"," 0.63526316"
"1"," 0.68736842"
"1"," 0.73947368"
"1"," 0.79157895"
"1","
"
"1","[17]"
"1"," 0.84368421"
"1"," 0.89578947"
"1"," 0.94789474"
"1"," 1.00000000"
"1","
"
"0","density.estimates = lapply(h.grid, function(h) density(z, bw = h, n = 512, from = -3, to = 3))"
"0","first.density.estimate = density.estimates[[1]]"
"0",""
"0","ISE = function(f, fhat)"
"0","mean((fhat- f)^2)"
"0","ISE.h = sapply(density.estimates, function(d) ISE(d$y, dnorm(d$x)))"
"0","# for each KDE, computes ISE."
"0","plot(h.grid, ISE.h, type = ""l"", main = ""ISE(h)"",xlab = ""Bandwidth (h)"", ylab = ""ISE"")"
